import Data.List (intercalate)

quotes :: [String]
quotes =
  [ "Запомни: всего одна ошибка - и ты ошибся."
  , "Делай, как надо. Как не надо, не делай."
  , "Работа - это не волк. Работа - ворк. А волк - это ходить."
  , "Не будьте эгоистами, в первую очередь думайте о себе!"
  , "Мы должны оставаться мыми, а они - оними."
  , "Марианскую впадину знаешь? Это я упал."
  , "Как говорил мой дед, \"Я твой дед\"."
  , "Жи-ши пиши от души."
  , "Без подошвы тапочки - это просто тряпочки."
  , "Слово - не воробей. Вообще ничто не воробей, кроме самого воробья."
  , "Если тебе где-то не рады в рваных носках, то и в целых туда идти не стоит."
  , "Работа не волк. Никто не волк. Только волк волк."
  , "Если закрыть глаза, становится темно."
  , "Тут - это вам не там."
  , "Кто рано встаёт - тому весь день спать хочется."
  ]

-- Функция для получения цитаты по индексу (от 1 до 15)
getQuote :: Int -> String
getQuote n
  | n >= 1 && n <= length quotes = quotes !! (n - 1)
  | otherwise = "Цитата не найдена."

-- Обработка ввода: возвращает список строк вывода
processInputs :: [String] -> [String]
processInputs (input : rest) =
  case input of
    "x" -> ["\n"]
    _   -> case reads input of
      [(n, "")] | n >= 1 && n <= 15 ->
        let quote = getQuote n
        in (quote ++ "\n\nВыберите число от 1 до 15 или 'n' для выхода: ") : processInputs rest
      _ -> ("Некорректный ввод. Введите число от 1 до 15 или 'n' для выхода.\n\n" ++ 
            "Выберите число от 1 до 15 или 'n' для выхода: ") : processInputs rest
processInputs [] = []

main :: IO ()
main = do
  putStr "Выберите число от 1 до 15 или 'n' для выхода: "
  inputLines <- fmap lines getContents
  let outputs = processInputs inputLines
  putStr $ intercalate "" outputs